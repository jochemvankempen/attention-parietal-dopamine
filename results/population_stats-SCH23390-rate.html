<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="data:text/css,%0A%40font%2Dface%20%7B%0Afont%2Dfamily%3A%20octicons%2Dlink%3B%0Asrc%3A%20url%28data%3Afont%2Fwoff%3Bcharset%3Dutf%2D8%3Bbase64%2Cd09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM%2B8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB%2FaFGpk3jaTY6xa8JAGMW%2FO62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v%2Bk%2F0an2i%2BitHDw3v2%2B9%2BDBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3%2FI7AtxEJLtzzuZfI%2BVVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy%2FLt7Kc%2B0vWY%2FgAgIIEqAN9we0pwKXreiMasxvabDQMM4riO%2BqxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw%2Bymhce7vwM9jSqO8JyVd5RH9gyTt2%2BJ%2FyUmYlIR0s04n6%2B7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv%2FocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi%2BW2%2BMjCzMIDApSwvXzC97Z4Ig8N%2FBxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh%2F8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT%2BAEjAwuDFpBmA9KMDEwMCh9i%2Fv8H8sH0%2F4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9%2FlqYwOGZxeUelN2U2R6%2BcArgtCJpauW7UQBqnFkUsjAY%2FkOU1cP%2BDAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl%2BvvmM%2FbyA48e6tWrKArm4ZJlCbdsrxksL1AwWn%2FyBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO%2F%2FsdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd%2F89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF%2B9JOS0nbaaYDCQfwCJ7Au3AHj%2BLO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm%2BEBXuAbHmIMSRMs%2B4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL%2BhD7C1xoaHeLJSEao0FEW14ckxC%2BTU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13%2F%2Blm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl%2B9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O%2FAdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB%2F%2F%2FAA8AAQAAAAAAAAAAAAAAAAABAAAAAA%3D%3D%29%20format%28%27woff%27%29%3B%0A%7D%0Abody%20%7B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0Atext%2Dsize%2Dadjust%3A%20100%25%3B%0Acolor%3A%20%23333%3B%0Afont%2Dfamily%3A%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20%22Segoe%20UI%22%2C%20Arial%2C%20freesans%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0Afont%2Dsize%3A%2016px%3B%0Aline%2Dheight%3A%201%2E6%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0A%7D%0Aa%20%7B%0Abackground%2Dcolor%3A%20transparent%3B%0A%7D%0Aa%3Aactive%2C%0Aa%3Ahover%20%7B%0Aoutline%3A%200%3B%0A%7D%0Astrong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%202em%3B%0Amargin%3A%200%2E67em%200%3B%0A%7D%0Aimg%20%7B%0Aborder%3A%200%3B%0A%7D%0Ahr%20%7B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Aheight%3A%200%3B%0A%7D%0Apre%20%7B%0Aoverflow%3A%20auto%3B%0A%7D%0Acode%2C%0Akbd%2C%0Apre%20%7B%0Afont%2Dfamily%3A%20monospace%2C%20monospace%3B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ainput%20%7B%0Acolor%3A%20inherit%3B%0Afont%3A%20inherit%3B%0Amargin%3A%200%3B%0A%7D%0Ahtml%20input%5Bdisabled%5D%20%7B%0Acursor%3A%20default%3B%0A%7D%0Ainput%20%7B%0Aline%2Dheight%3A%20normal%3B%0A%7D%0Ainput%5Btype%3D%22checkbox%22%5D%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Apadding%3A%200%3B%0A%7D%0Atable%20%7B%0Aborder%2Dcollapse%3A%20collapse%3B%0Aborder%2Dspacing%3A%200%3B%0A%7D%0Atd%2C%0Ath%20%7B%0Apadding%3A%200%3B%0A%7D%0A%2A%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0Ainput%20%7B%0Afont%3A%2013px%20%2F%201%2E4%20Helvetica%2C%20arial%2C%20nimbussansl%2C%20liberationsans%2C%20freesans%2C%20clean%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%234078c0%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%2C%0Aa%3Aactive%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%200%3B%0Amargin%3A%2015px%200%3B%0Aoverflow%3A%20hidden%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0Ahr%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ahr%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%2015px%3B%0Amargin%2Dbottom%3A%2015px%3B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%2030px%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%2021px%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%2016px%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%2011px%3B%0A%7D%0Ablockquote%20%7B%0Amargin%3A%200%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aol%20ol%2C%0Aul%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Droman%3B%0A%7D%0Aul%20ul%20ol%2C%0Aul%20ol%20ol%2C%0Aol%20ul%20ol%2C%0Aol%20ol%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Dalpha%3B%0A%7D%0Add%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0Afont%3A%2012px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0A%7D%0A%2Eselect%3A%3A%2Dms%2Dexpand%20%7B%0Aopacity%3A%200%3B%0A%7D%0A%2Eocticon%20%7B%0Afont%3A%20normal%20normal%20normal%2016px%2F1%20octicons%2Dlink%3B%0Adisplay%3A%20inline%2Dblock%3B%0Atext%2Ddecoration%3A%20none%3B%0Atext%2Drendering%3A%20auto%3B%0A%2Dwebkit%2Dfont%2Dsmoothing%3A%20antialiased%3B%0A%2Dmoz%2Dosx%2Dfont%2Dsmoothing%3A%20grayscale%3B%0A%2Dwebkit%2Duser%2Dselect%3A%20none%3B%0A%2Dmoz%2Duser%2Dselect%3A%20none%3B%0A%2Dms%2Duser%2Dselect%3A%20none%3B%0Auser%2Dselect%3A%20none%3B%0A%7D%0A%2Eocticon%2Dlink%3Abefore%20%7B%0Acontent%3A%20%27%5Cf05c%27%3B%0A%7D%0A%2Emarkdown%2Dbody%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%20%21important%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%20%21important%3B%0A%7D%0Aa%3Anot%28%5Bhref%5D%29%20%7B%0Acolor%3A%20inherit%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0A%2Eanchor%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%2Dright%3A%202px%3B%0Amargin%2Dleft%3A%20%2D18px%3B%0A%7D%0A%2Eanchor%3Afocus%20%7B%0Aoutline%3A%20none%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%201em%3B%0Amargin%2Dbottom%3A%2016px%3B%0Afont%2Dweight%3A%20bold%3B%0Aline%2Dheight%3A%201%2E4%3B%0A%7D%0Ah1%20%2Eocticon%2Dlink%2C%0Ah2%20%2Eocticon%2Dlink%2C%0Ah3%20%2Eocticon%2Dlink%2C%0Ah4%20%2Eocticon%2Dlink%2C%0Ah5%20%2Eocticon%2Dlink%2C%0Ah6%20%2Eocticon%2Dlink%20%7B%0Acolor%3A%20%23000%3B%0Avertical%2Dalign%3A%20middle%3B%0Avisibility%3A%20hidden%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%2C%0Ah2%3Ahover%20%2Eanchor%2C%0Ah3%3Ahover%20%2Eanchor%2C%0Ah4%3Ahover%20%2Eanchor%2C%0Ah5%3Ahover%20%2Eanchor%2C%0Ah6%3Ahover%20%2Eanchor%20%7B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah2%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah3%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah4%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah5%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah6%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%20%7B%0Avisibility%3A%20visible%3B%0A%7D%0Ah1%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%202%2E25em%3B%0Aline%2Dheight%3A%201%2E2%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah1%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah2%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%201%2E75em%3B%0Aline%2Dheight%3A%201%2E225%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah2%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0Aline%2Dheight%3A%201%2E43%3B%0A%7D%0Ah3%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E25em%3B%0A%7D%0Ah4%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ah5%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%201em%3B%0Acolor%3A%20%23777%3B%0A%7D%0Ah6%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ap%2C%0Ablockquote%2C%0Aul%2C%0Aol%2C%0Adl%2C%0Atable%2C%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%204px%3B%0Apadding%3A%200%3B%0Amargin%3A%2016px%200%3B%0Abackground%2Dcolor%3A%20%23e7e7e7%3B%0Aborder%3A%200%20none%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%2Dleft%3A%202em%3B%0A%7D%0Aul%20ul%2C%0Aul%20ol%2C%0Aol%20ol%2C%0Aol%20ul%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Ali%3Ep%20%7B%0Amargin%2Dtop%3A%2016px%3B%0A%7D%0Adl%20%7B%0Apadding%3A%200%3B%0A%7D%0Adl%20dt%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%2016px%3B%0Afont%2Dsize%3A%201em%3B%0Afont%2Dstyle%3A%20italic%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Adl%20dd%20%7B%0Apadding%3A%200%2016px%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ablockquote%20%7B%0Apadding%3A%200%2015px%3B%0Acolor%3A%20%23777%3B%0Aborder%2Dleft%3A%204px%20solid%20%23ddd%3B%0A%7D%0Ablockquote%3E%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Ablockquote%3E%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Atable%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Aoverflow%3A%20auto%3B%0Aword%2Dbreak%3A%20normal%3B%0Aword%2Dbreak%3A%20keep%2Dall%3B%0A%7D%0Atable%20th%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Atable%20th%2C%0Atable%20td%20%7B%0Apadding%3A%206px%2013px%3B%0Aborder%3A%201px%20solid%20%23ddd%3B%0A%7D%0Atable%20tr%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ccc%3B%0A%7D%0Atable%20tr%3Anth%2Dchild%282n%29%20%7B%0Abackground%2Dcolor%3A%20%23f8f8f8%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0A%7D%0Acode%20%7B%0Apadding%3A%200%3B%0Apadding%2Dtop%3A%200%2E2em%3B%0Apadding%2Dbottom%3A%200%2E2em%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%2085%25%3B%0Abackground%2Dcolor%3A%20rgba%280%2C0%2C0%2C0%2E04%29%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0Acode%3Abefore%2C%0Acode%3Aafter%20%7B%0Aletter%2Dspacing%3A%20%2D0%2E2em%3B%0Acontent%3A%20%22%5C00a0%22%3B%0A%7D%0Apre%3Ecode%20%7B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%20100%25%3B%0Aword%2Dbreak%3A%20normal%3B%0Awhite%2Dspace%3A%20pre%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0A%2Ehighlight%20%7B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0A%2Ehighlight%20pre%2C%0Apre%20%7B%0Apadding%3A%2016px%3B%0Aoverflow%3A%20auto%3B%0Afont%2Dsize%3A%2085%25%3B%0Aline%2Dheight%3A%201%2E45%3B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0A%2Ehighlight%20pre%20%7B%0Amargin%2Dbottom%3A%200%3B%0Aword%2Dbreak%3A%20normal%3B%0A%7D%0Apre%20%7B%0Aword%2Dwrap%3A%20normal%3B%0A%7D%0Apre%20code%20%7B%0Adisplay%3A%20inline%3B%0Amax%2Dwidth%3A%20initial%3B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Aoverflow%3A%20initial%3B%0Aline%2Dheight%3A%20inherit%3B%0Aword%2Dwrap%3A%20normal%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0Apre%20code%3Abefore%2C%0Apre%20code%3Aafter%20%7B%0Acontent%3A%20normal%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%2Dsize%3A%2011px%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Epl%2Dc%20%7B%0Acolor%3A%20%23969896%3B%0A%7D%0A%2Epl%2Dc1%2C%0A%2Epl%2Ds%20%2Epl%2Dv%20%7B%0Acolor%3A%20%230086b3%3B%0A%7D%0A%2Epl%2De%2C%0A%2Epl%2Den%20%7B%0Acolor%3A%20%23795da3%3B%0A%7D%0A%2Epl%2Ds%20%2Epl%2Ds1%2C%0A%2Epl%2Dsmi%20%7B%0Acolor%3A%20%23333%3B%0A%7D%0A%2Epl%2Dent%20%7B%0Acolor%3A%20%2363a35c%3B%0A%7D%0A%2Epl%2Dk%20%7B%0Acolor%3A%20%23a71d5d%3B%0A%7D%0A%2Epl%2Dpds%2C%0A%2Epl%2Ds%2C%0A%2Epl%2Ds%20%2Epl%2Dpse%20%2Epl%2Ds1%2C%0A%2Epl%2Dsr%2C%0A%2Epl%2Dsr%20%2Epl%2Dcce%2C%0A%2Epl%2Dsr%20%2Epl%2Dsra%2C%0A%2Epl%2Dsr%20%2Epl%2Dsre%20%7B%0Acolor%3A%20%23183691%3B%0A%7D%0A%2Epl%2Dv%20%7B%0Acolor%3A%20%23ed6a43%3B%0A%7D%0A%2Epl%2Did%20%7B%0Acolor%3A%20%23b52a1d%3B%0A%7D%0A%2Epl%2Dii%20%7B%0Abackground%2Dcolor%3A%20%23b52a1d%3B%0Acolor%3A%20%23f8f8f8%3B%0A%7D%0A%2Epl%2Dsr%20%2Epl%2Dcce%20%7B%0Acolor%3A%20%2363a35c%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dml%20%7B%0Acolor%3A%20%23693a17%3B%0A%7D%0A%2Epl%2Dmh%2C%0A%2Epl%2Dmh%20%2Epl%2Den%2C%0A%2Epl%2Dms%20%7B%0Acolor%3A%20%231d3e81%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmq%20%7B%0Acolor%3A%20%23008080%3B%0A%7D%0A%2Epl%2Dmi%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0A%2Epl%2Dmb%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmd%20%7B%0Abackground%2Dcolor%3A%20%23ffecec%3B%0Acolor%3A%20%23bd2c00%3B%0A%7D%0A%2Epl%2Dmi1%20%7B%0Abackground%2Dcolor%3A%20%23eaffea%3B%0Acolor%3A%20%2355a532%3B%0A%7D%0A%2Epl%2Dmdr%20%7B%0Acolor%3A%20%23795da3%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmo%20%7B%0Acolor%3A%20%231d3e81%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%3A%2011px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20%7B%0Alist%2Dstyle%2Dtype%3A%20none%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%2B%2Etask%2Dlist%2Ditem%20%7B%0Amargin%2Dtop%3A%203px%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20input%20%7B%0Amargin%3A%200%200%2E35em%200%2E25em%20%2D1%2E6em%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0A%3Achecked%2B%2Eradio%2Dlabel%20%7B%0Az%2Dindex%3A%201%3B%0Aposition%3A%20relative%3B%0Aborder%2Dcolor%3A%20%234078c0%3B%0A%7D%0A%2EsourceLine%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0A%7D%0Acode%20%2Ekw%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Edt%20%7B%20color%3A%20%23ed6a43%3B%20%7D%0Acode%20%2Edv%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ebn%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Efl%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ech%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Est%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eco%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Eot%20%7B%20color%3A%20%230086b3%3B%20%7D%0Acode%20%2Eal%20%7B%20color%3A%20%23a61717%3B%20%7D%0Acode%20%2Efu%20%7B%20color%3A%20%2363a35c%3B%20%7D%0Acode%20%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%0Acode%20%2Ewa%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ecn%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Esc%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Evs%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Ess%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eim%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eva%20%7Bcolor%3A%20%23008080%3B%20%7D%0Acode%20%2Ecf%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eop%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ebu%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eex%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Epp%20%7B%20color%3A%20%23999999%3B%20%7D%0Acode%20%2Eat%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Edo%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Ean%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ecv%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ein%20%7B%20color%3A%20%23008080%3B%20%7D%0A">
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="population_stats-linear-mixed-effect-model-fit-to-attention-parietal-dopamine-data">population_stats: Linear mixed effect model fit to attention-parietal-dopamine data</h1>
<p>Jochem van Kempen 25 June, 2021</p>
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#packages">Packages</a></li>
<li><a href="#params">Params</a></li>
<li><a href="#set-files-and-directories">set files and directories</a></li>
<li><a href="#define-the-order-of-the-category-labels">define the order of the category labels</a></li>
<li><a href="#load-and-prep-data">load and prep data</a></li>
<li><a href="#mixed-level-model">mixed-level model</a>
<ul>
<li><a href="#fit-models">fit models</a></li>
<li><a href="#compare-models">compare models</a></li>
<li><a href="#coefficient-confidence-intervals">coefficient confidence intervals</a></li>
<li><a href="#parametric-bootstrap-model-fits">parametric bootstrap model fits</a></li>
<li><a href="#kenward-roger-approximation">Kenward-roger approximation</a></li>
<li><a href="#bayes-factor">Bayes factor</a></li>
</ul></li>
</ul>
<h2 id="summary">Summary</h2>
<p>Statistical analyses for the paper:</p>
<p>Dopamine influences attentional rate modulation in Macaque posterior parietal cortex</p>
<p>Jochem van Kempen, Christian Brandt, Claudia Distler, Mark A. Bellgrove, Alexander Thiele</p>
<p>Application of mixed effect models to test the relationship between attention, drug application and unit type on firing rates, fano factors (FF) and gain variability during application of the general dopaminergic agonist dopamine and the D1-specific antagonist SCH23390.</p>
<h2 id="packages">Packages</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;tidyverse&quot;</span>,<span class="st">&quot;dplyr&quot;</span>,<span class="st">&quot;lme4&quot;</span>,<span class="st">&quot;lmerTest&quot;</span>,<span class="st">&quot;MASS&quot;</span>,<span class="st">&quot;pbkrtest&quot;</span>,<span class="st">&quot;parallel&quot;</span>,<span class="st">&quot;MuMIn&quot;</span>,<span class="st">&quot;varhandle&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(x, <span class="cf">function</span>(x) {<span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(x, <span class="at">character.only=</span>T)) {<span class="fu">install.packages</span>(x);<span class="fu">require</span>(x)}})</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # remove unnecessary variables</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rm.all.but(keep=c(&quot;params&quot;), envir=.GlobalEnv, keep_functions=TRUE, gc_limit=100,</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            regex=&quot;auto&quot;)</span></span></code></pre></div>
<h2 id="params">Params</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>selectivity_criterium <span class="ot">=</span> <span class="st">&#39;att&amp;dru&#39;</span> <span class="co"># which units to analyse</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&#39;Running population_stats.Rmd with params:</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(params)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Running population_stats.Rmd with params:\n&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="do">## $drugname</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;SCH23390&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="do">## $dependent_variable</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;rate&quot;</span></span></code></pre></div>
<h2 id="set-files-and-directories">set files and directories</h2>
<h2 id="define-the-order-of-the-category-labels">define the order of the category labels</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set predictor levels (their order)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>label_attention <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;Attend RF&#39;</span>,<span class="st">&#39;Attend away&#39;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>label_drug_onoff <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;Drug on&#39;</span>,<span class="st">&#39;Drug off&#39;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>label_unitclass <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;Narrow&#39;</span>,<span class="st">&#39;Broad&#39;</span>)</span></code></pre></div>
<h2 id="load-and-prep-data">load and prep data</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>populationdata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">str_c</span>(filedir, filename,<span class="st">&#39;.csv&#39;</span>))</span></code></pre></div>
<pre><code>## 
## -- Column specification --------------------------------------------------------
## cols(
##   .default = col_double(),
##   drug_on = col_character(),
##   attention = col_character(),
##   Subject = col_character(),
##   Task = col_character(),
##   Date = col_date(format = &quot;&quot;),
##   Drug = col_character(),
##   unit_class = col_character(),
##   attention_drug_on = col_character()
## )
## i Use `spec()` for the full column specifications.</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select units from the recordings with drug &quot;params$drugname&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>populationdata <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(populationdata, Drug<span class="sc">==</span>params<span class="sc">$</span>drugname)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set categorical variables</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>populationdata<span class="sc">$</span>Drug <span class="ot">&lt;-</span> <span class="fu">factor</span>(populationdata<span class="sc">$</span>Drug, <span class="at">ordered=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>populationdata<span class="sc">$</span>attention <span class="ot">&lt;-</span> <span class="fu">factor</span>(populationdata<span class="sc">$</span>attention, <span class="at">ordered=</span><span class="cn">FALSE</span>, <span class="at">levels=</span>label_attention)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>populationdata<span class="sc">$</span>drug_on <span class="ot">&lt;-</span> <span class="fu">factor</span>(populationdata<span class="sc">$</span>drug_on, <span class="at">ordered=</span><span class="cn">FALSE</span>, <span class="at">levels=</span>label_drug_onoff)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>populationdata<span class="sc">$</span>unit_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(populationdata<span class="sc">$</span>unit_class, <span class="at">ordered=</span><span class="cn">FALSE</span>, <span class="at">levels=</span>label_unitclass)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>populationdata<span class="sc">$</span>unit <span class="ot">&lt;-</span> <span class="fu">factor</span>(populationdata<span class="sc">$</span>unit, <span class="at">ordered=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># set contrasts to sum (intercept is grand mean, effect-coded contrasts)</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>populationdata<span class="sc">$</span>attention <span class="ot">&lt;-</span> <span class="fu">C</span>(populationdata<span class="sc">$</span>attention, <span class="st">&quot;contr.sum&quot;</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>populationdata<span class="sc">$</span>drug_on <span class="ot">&lt;-</span> <span class="fu">C</span>(populationdata<span class="sc">$</span>drug_on, <span class="st">&quot;contr.sum&quot;</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>populationdata<span class="sc">$</span>unit_class <span class="ot">&lt;-</span> <span class="fu">C</span>(populationdata<span class="sc">$</span>unit_class, <span class="st">&quot;contr.sum&quot;</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(populationdata)</span></code></pre></div>
<pre><code>## # A tibble: 56 x 27
##    unit  drug_on  attention  rate    FF   roc      MI   gain gain_log Subject
##    &lt;fct&gt; &lt;fct&gt;    &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  
##  1 32    Drug off Attend RF 29.2   2.87 0.797  0.207  0.0650   -2.73  W      
##  2 34    Drug off Attend RF 18.2   1.79 0.760  0.197  0.0356   -3.34  W      
##  3 40    Drug off Attend RF 27.7   3.10 0.291 -0.112  0.0703   -2.66  W      
##  4 46    Drug off Attend RF 32.8   1.61 0.837  0.186  0.0177   -4.04  W      
##  5 51    Drug off Attend RF 17.2   4.79 0.737  0.266  0.202    -1.60  W      
##  6 52    Drug off Attend RF 13.2   5.61 0.746  0.310  0.314    -1.16  W      
##  7 54    Drug off Attend RF 17.7   3.82 0.712  0.200  0.150    -1.90  W      
##  8 55    Drug off Attend RF 37.4   3.47 0.562  0.0446 0.0555   -2.89  W      
##  9 57    Drug off Attend RF  8.70  2.71 0.605  0.113  0.219    -1.52  W      
## 10 58    Drug off Attend RF 12.5   4.74 0.737  0.310  0.407    -0.900 W      
## # ... with 46 more rows, and 17 more variables: Task &lt;chr&gt;, Date &lt;date&gt;,
## #   Drug &lt;fct&gt;, EjectCurrent &lt;dbl&gt;, Weight &lt;dbl&gt;, peak_to_trough_time &lt;dbl&gt;,
## #   unit_class &lt;fct&gt;, EjectCurrent_centered &lt;dbl&gt;, s_stim &lt;dbl&gt;, s_att &lt;dbl&gt;,
## #   s_dru &lt;dbl&gt;, s_dir &lt;dbl&gt;, s_att*dru &lt;dbl&gt;, s_att*dir &lt;dbl&gt;,
## #   s_dru*dir &lt;dbl&gt;, s_att*dru*dir &lt;dbl&gt;, attention_drug_on &lt;chr&gt;</code></pre>
<h2 id="mixed-level-model">mixed-level model</h2>
<h3 id="fit-models">fit models</h3>
<p>Sequentially add predictors to predict neural activity (defined in <code>params$dependent_variable</code>). We add random intercepts for <code>unit</code> to account for the repeated measurements in the data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#intercept only</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>model.base <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(<span class="at">formula =</span> <span class="fu">formula</span>(<span class="fu">paste</span>(params<span class="sc">$</span>dependent_variable,<span class="st">&quot; ~ 1 + (1|unit)&quot;</span>)), </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> populationdata, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">na.action =</span> na.omit, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">REML =</span> <span class="cn">FALSE</span>) </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># main effects</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>model.att <span class="ot">&lt;-</span> <span class="fu">update</span>(model.base, .<span class="sc">~</span>. <span class="sc">+</span> attention) </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>model.drug <span class="ot">&lt;-</span> <span class="fu">update</span>(model.att, .<span class="sc">~</span>. <span class="sc">+</span> drug_on) </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>model.unitc <span class="ot">&lt;-</span> <span class="fu">update</span>(model.drug, .<span class="sc">~</span>. <span class="sc">+</span> unit_class) </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction </span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>model.att_drug <span class="ot">&lt;-</span> <span class="fu">update</span>(model.unitc, .<span class="sc">~</span>. <span class="sc">+</span> attention<span class="sc">*</span>drug_on) </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>model.att_unitc <span class="ot">&lt;-</span> <span class="fu">update</span>(model.att_drug, .<span class="sc">~</span>. <span class="sc">+</span> attention<span class="sc">*</span>unit_class) </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>model.drug_unitc <span class="ot">&lt;-</span> <span class="fu">update</span>(model.att_unitc, .<span class="sc">~</span>. <span class="sc">+</span> drug_on<span class="sc">*</span>unit_class) </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>model.att_drug_unitc <span class="ot">&lt;-</span> <span class="fu">update</span>(model.att_unitc, .<span class="sc">~</span>. <span class="sc">+</span> attention<span class="sc">*</span>drug_on<span class="sc">*</span>unit_class) </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.att_drug_unitc)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite&#39;s
##   method [lmerModLmerTest]
## Formula: 
## rate ~ (1 | unit) + attention + drug_on + unit_class + attention:drug_on +  
##     attention:unit_class + drug_on:unit_class + attention:drug_on:unit_class
##    Data: populationdata
## 
##      AIC      BIC   logLik deviance df.resid 
##    356.6    376.9   -168.3    336.6       46 
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -1.52930 -0.69204 -0.07002  0.52220  2.47289 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  unit     (Intercept) 95.59    9.777   
##  Residual              9.40    3.066   
## Number of obs: 56, groups:  unit, 14
## 
## Fixed effects:
##                                 Estimate Std. Error      df t value Pr(&gt;|t|)
## (Intercept)                      16.2300     3.2229 14.0000   5.036 0.000182
## attention1                        3.3342     0.4992 42.0000   6.678  4.2e-08
## drug_on1                         -1.2895     0.4992 42.0000  -2.583 0.013374
## unit_class1                       0.5384     3.2229 14.0000   0.167 0.869717
## attention1:drug_on1              -0.2638     0.4992 42.0000  -0.528 0.600030
## attention1:unit_class1            1.3506     0.4992 42.0000   2.705 0.009816
## drug_on1:unit_class1              0.1324     0.4992 42.0000   0.265 0.792191
## attention1:drug_on1:unit_class1  -0.1747     0.4992 42.0000  -0.350 0.728196
##                                    
## (Intercept)                     ***
## attention1                      ***
## drug_on1                        *  
## unit_class1                        
## attention1:drug_on1                
## attention1:unit_class1          ** 
## drug_on1:unit_class1               
## attention1:drug_on1:unit_class1    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) attnt1 drg_n1 unt_c1 attntn1:d_1 attntn1:n_1 d_1:_1
## attention1  0.000                                                     
## drug_on1    0.000  0.000                                              
## unit_class1 0.571  0.000  0.000                                       
## attntn1:d_1 0.000  0.000  0.000  0.000                                
## attntn1:n_1 0.000  0.571  0.000  0.000  0.000                         
## drg_n1:nt_1 0.000  0.000  0.571  0.000  0.000       0.000             
## attn1:_1:_1 0.000  0.000  0.000  0.000  0.571       0.000       0.000</code></pre>
<!-- ### stepwise regression -->

<!-- Because some variables could be correlated, we used an algorithm for forward/backward step- wise model selection (Venables WN, Ripley BD. 2002. Modern Applied Statistics with S. Fourth ed. New York: Springer) to test whether each predictor indeed explained independent variability that is not explained by any of the other predictors. This procedure can eliminate correlated predictors from the final model. -->

<!-- ```{r stepwise regression, results='hold'} -->

<!-- # -->

<!-- # model.full <- lmerTest::lmer(formula = formula(paste(params$dependent_variable," ~ 1 + attention + drug_on + unit_class + attention*drug_on + attention*unit_class + drug_on*unit_class + attention*drug_on*unit_class + (1|unit)")), -->

<!-- #                              data=populationdata, na.action=na.omit, REML=FALSE) # intercept only -->

<!-- # model.step <- lmerTest::step(model.full, direction='both') -->

<!-- model.step <- lmerTest::step(model.att_drug_unitc, direction='both') -->

<!-- model.step -->

<!-- ``` -->

<h3 id="compare-models">compare models</h3>
<p>Now test whether the addition of a predictor provides a better model fit (explains more variance) using likelihood ratio tests at every stage.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare model fits</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>model.comparison <span class="ot">&lt;-</span> <span class="fu">anova</span>(model.base,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                          model.att,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                          model.drug,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                          model.unitc,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                          model.att_drug,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                          model.att_unitc,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                          model.drug_unitc,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                          model.att_drug_unitc)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model.comparison)</span></code></pre></div>
<pre><code>## Warning in tidy.anova(model.comparison): The following column names in ANOVA
## output were not recognized or transformed: npar

## # A tibble: 8 x 9
##   term               npar   AIC   BIC logLik deviance statistic    df    p.value
##   &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 model.base            3  379.  385.  -187.     373.   NA         NA   NA      
## 2 model.att             4  360.  368.  -176.     352.   20.9        1    4.92e-6
## 3 model.drug            5  354.  364.  -172.     344.    8.47       1    3.61e-3
## 4 model.unitc           6  356.  368.  -172.     344.    0.0279     1    8.67e-1
## 5 model.att_drug        7  358.  372.  -172.     344.    0.136      1    7.13e-1
## 6 model.att_unitc       8  353.  369.  -168.     337.    6.72       1    9.54e-3
## 7 model.drug_unitc      9  355.  373.  -168.     337.    0.0700     1    7.91e-1
## 8 model.att_drug_u~    10  357.  377.  -168.     337.    0.122      1    7.27e-1</code></pre>
<h3 id="coefficient-confidence-intervals">coefficient confidence intervals</h3>
<p>Use robust regression (bootstrap) to obtain confidence intervals</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run bootstrap to produce 95% confidence intervals</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">confint</span>(model.att_drug_unitc, <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;boot&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nsim =</span> <span class="dv">5000</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">boot.type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;norm&quot;</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">FUN =</span> <span class="cn">NULL</span>, <span class="at">quiet =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">oldNames =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cl =</span> clus</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div>
<pre><code>## Computing bootstrap confidence intervals ...</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">.sig01</td>
<td align="right">5.2700436</td>
<td align="right">12.6075899</td>
</tr>
<tr class="even">
<td align="left">.sigma</td>
<td align="right">2.1792206</td>
<td align="right">3.4635653</td>
</tr>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">9.7544655</td>
<td align="right">22.6657174</td>
</tr>
<tr class="even">
<td align="left">attention1</td>
<td align="right">2.3380607</td>
<td align="right">4.3040035</td>
</tr>
<tr class="odd">
<td align="left">drug_on1</td>
<td align="right">-2.3046998</td>
<td align="right">-0.2871521</td>
</tr>
<tr class="even">
<td align="left">unit_class1</td>
<td align="right">-5.8004528</td>
<td align="right">6.8484918</td>
</tr>
<tr class="odd">
<td align="left">attention1:drug_on1</td>
<td align="right">-1.2304887</td>
<td align="right">0.7545406</td>
</tr>
<tr class="even">
<td align="left">attention1:unit_class1</td>
<td align="right">0.3747557</td>
<td align="right">2.3329712</td>
</tr>
<tr class="odd">
<td align="left">drug_on1:unit_class1</td>
<td align="right">-0.8628436</td>
<td align="right">1.1236456</td>
</tr>
<tr class="even">
<td align="left">attention1:drug_on1:unit_class1</td>
<td align="right">-1.1844914</td>
<td align="right">0.8060692</td>
</tr>
</tbody>
</table>
<h3 id="parametric-bootstrap-model-fits">parametric bootstrap model fits</h3>
<p>We check the model comparisons using parametric bootstrap to control for Type I errors, as described in the paper <a href="https://www.jstatsoft.org/article/view/v059i09">“A Kenward-Roger Approximation and Parametric Bootstrap Methods for Tests in Linear Mixed Models The R Package pbkrtest”</a>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check whether params$dependent_variable has NA values. Bootstrap does not work with NA values</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>populationdata_na <span class="ot">&lt;-</span> populationdata[<span class="fu">complete.cases</span>(populationdata),]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># na.omit(populationdata)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># run models again without NA values</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#intercept only</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>model_na.base <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(<span class="at">formula =</span> <span class="fu">formula</span>(<span class="fu">paste</span>(params<span class="sc">$</span>dependent_variable,<span class="st">&quot; ~ 1 + (1|unit)&quot;</span>)),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> populationdata_na,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">na.action =</span> na.omit,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># main effects</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>model_na.att <span class="ot">&lt;-</span> <span class="fu">update</span>(model_na.base, .<span class="sc">~</span>. <span class="sc">+</span> attention)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>model_na.drug <span class="ot">&lt;-</span> <span class="fu">update</span>(model_na.att, .<span class="sc">~</span>. <span class="sc">+</span> drug_on)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>model_na.unitc <span class="ot">&lt;-</span> <span class="fu">update</span>(model_na.drug, .<span class="sc">~</span>. <span class="sc">+</span> unit_class)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>model_na.att_drug <span class="ot">&lt;-</span> <span class="fu">update</span>(model_na.unitc, .<span class="sc">~</span>. <span class="sc">+</span> attention<span class="sc">*</span>drug_on)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>model_na.att_unitc <span class="ot">&lt;-</span> <span class="fu">update</span>(model_na.att_drug, .<span class="sc">~</span>. <span class="sc">+</span> attention<span class="sc">*</span>unit_class)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>model_na.drug_unitc <span class="ot">&lt;-</span> <span class="fu">update</span>(model_na.att_unitc, .<span class="sc">~</span>. <span class="sc">+</span> drug_on<span class="sc">*</span>unit_class)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>model_na.att_drug_unitc <span class="ot">&lt;-</span> <span class="fu">update</span>(model_na.att_unitc, .<span class="sc">~</span>. <span class="sc">+</span> attention<span class="sc">*</span>drug_on<span class="sc">*</span>unit_class)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># run on multiple cores</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>nc <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>clus <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(<span class="fu">rep</span>(<span class="st">&quot;localhost&quot;</span>, nc))</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>bootstrap.att <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">PBmodcomp</span>(model_na.att, model_na.base, <span class="at">cl =</span> clus)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>bootstrap.drug <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">PBmodcomp</span>(model_na.drug, model_na.att, <span class="at">cl =</span> clus)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>bootstrap.unitc <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">PBmodcomp</span>(model_na.unitc, model_na.drug, <span class="at">cl =</span> clus)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>bootstrap.att_drug <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">PBmodcomp</span>(model_na.att_drug, model_na.unitc, <span class="at">cl =</span> clus)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>bootstrap.att_unitc <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">PBmodcomp</span>(model_na.att_unitc, model_na.att_drug, <span class="at">cl =</span> clus)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>bootstrap.drug_unitc <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">PBmodcomp</span>(model_na.drug_unitc, model_na.att_unitc, <span class="at">cl =</span> clus)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>bootstrap.att_drug_unitc <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">PBmodcomp</span>(model_na.att_drug_unitc, model_na.drug_unitc, <span class="at">cl =</span> clus)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">c</span>(<span class="st">&quot;bootstrap.att&quot;</span>, <span class="st">&quot;bootstrap.drug&quot;</span>, <span class="st">&quot;bootstrap.unitc&quot;</span>, <span class="st">&quot;bootstrap.att_drug&quot;</span>,<span class="st">&quot;bootstrap.att_unitc&quot;</span>,<span class="st">&quot;bootstrap.drug_unitc&quot;</span>,<span class="st">&quot;bootstrap.att_drug_unitc&quot;</span>),</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">c</span>(bootstrap.att<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">1</span>], bootstrap.drug<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">1</span>], bootstrap.unitc<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">1</span>], bootstrap.att_drug<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">1</span>], bootstrap.att_unitc<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">1</span>], bootstrap.drug_unitc<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">1</span>], bootstrap.att_drug_unitc<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">1</span>]),</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootp =</span> <span class="fu">c</span>(bootstrap.att<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">2</span>], bootstrap.drug<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">2</span>], bootstrap.unitc<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">2</span>], bootstrap.att_drug<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">2</span>], bootstrap.att_unitc<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">2</span>], bootstrap.drug_unitc<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">2</span>], bootstrap.att_drug_unitc<span class="sc">$</span>test<span class="sc">$</span>p.value[<span class="dv">2</span>]),</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 7 x 3
##   id                               p    bootp
##   &lt;chr&gt;                        &lt;dbl&gt;    &lt;dbl&gt;
## 1 bootstrap.att            0.0000232 0.000999
## 2 bootstrap.drug           0.00480   0.00699 
## 3 bootstrap.unitc          0.667     0.710   
## 4 bootstrap.att_drug       0.941     0.951   
## 5 bootstrap.att_unitc      0.00349   0.00500 
## 6 bootstrap.drug_unitc     0.827     0.850   
## 7 bootstrap.att_drug_unitc 0.749     0.754</code></pre>
<h3 id="kenward-roger-approximation">Kenward-roger approximation</h3>
<p>We check the model comparisons using the Kenward-roger approximation for performing F-tests to control for Type I errors, as described in the paper <a href="https://www.jstatsoft.org/article/view/v059i09">“A Kenward-Roger Approximation and Parametric Bootstrap Methods for Tests in Linear Mixed Models The R Package pbkrtest”</a>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>KR.att <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">KRmodcomp</span>(model.att, model.base)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>KR.drug <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">KRmodcomp</span>(model.drug, model.att)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>KR.unitc <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">KRmodcomp</span>(model.unitc, model.drug)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>KR.att_drug <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">KRmodcomp</span>(model.att_drug, model.unitc)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>KR.att_unitc <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">KRmodcomp</span>(model.att_unitc, model.att_drug)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>KR.drug_unitc <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">KRmodcomp</span>(model.drug_unitc, model.att_unitc)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>KR.att_drug_unitc <span class="ot">&lt;-</span> pbkrtest<span class="sc">::</span><span class="fu">KRmodcomp</span>(model.att_drug_unitc, model.drug_unitc)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">c</span>(<span class="st">&quot;KR.att&quot;</span>, <span class="st">&quot;KR.drug&quot;</span>, <span class="st">&quot;KR.unitc&quot;</span>, <span class="st">&quot;KR.att_drug&quot;</span>,<span class="st">&quot;KR.att_unitc&quot;</span>,<span class="st">&quot;KR.drug_unitc&quot;</span>,<span class="st">&quot;KR.att_drug_unitc&quot;</span>),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">F =</span> <span class="fu">c</span>(KR.att<span class="sc">$</span>stats<span class="sc">$</span>Fstat, KR.drug<span class="sc">$</span>stats<span class="sc">$</span>Fstat, KR.unitc<span class="sc">$</span>stats<span class="sc">$</span>Fstat, KR.att_drug<span class="sc">$</span>stats<span class="sc">$</span>Fstat, KR.att_unitc<span class="sc">$</span>stats<span class="sc">$</span>Fstat, KR.drug_unitc<span class="sc">$</span>stats<span class="sc">$</span>Fstat, KR.att_drug_unitc<span class="sc">$</span>stats<span class="sc">$</span>Fstat),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">c</span>(KR.att<span class="sc">$</span>stats<span class="sc">$</span>p.value, KR.drug<span class="sc">$</span>stats<span class="sc">$</span>p.value, KR.unitc<span class="sc">$</span>stats<span class="sc">$</span>p.value, KR.att_drug<span class="sc">$</span>stats<span class="sc">$</span>p.value, KR.att_unitc<span class="sc">$</span>stats<span class="sc">$</span>p.value, KR.drug_unitc<span class="sc">$</span>stats<span class="sc">$</span>p.value, KR.att_drug_unitc<span class="sc">$</span>stats<span class="sc">$</span>p.value),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 7 x 3
##   id                      F          p
##   &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt;
## 1 KR.att            26.4    0.00000721
## 2 KR.drug            8.94   0.00476   
## 3 KR.unitc           0.0239 0.880     
## 4 KR.att_drug        0.126  0.724     
## 5 KR.att_unitc       6.59   0.0143    
## 6 KR.drug_unitc      0.0618 0.805     
## 7 KR.att_drug_unitc  0.105  0.748</code></pre>
<h3 id="bayes-factor">Bayes factor</h3>
<p>Compute bayes factor using BayesFactor package. Detailed description can be found in the paper <a href="https://journals.sagepub.com/doi/10.1177/0149206314560412">An Introduction to Bayesian Hypothesis Testing for Management Research</a>.</p>
<p>Interpretation of Bayes Factors is defined <a href="https://journals.sagepub.com/doi/10.1177/0149206314560412">here</a> in <a href="https://journals.sagepub.com/na101/home/literatum/publisher/sage/journals/content/joma/2015/joma_41_2/0149206314560412/20161119/images/medium/10.1177_0149206314560412-table1.gif">table 1</a>.</p>
<p>A nice illustration of the bayes factor is given <a href="https://alexanderetz.com/2015/08/09/understanding-bayes-visualization-of-bf/">here</a>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">dim</span>(populationdata)[<span class="dv">1</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># number of predictors</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>n_pred <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">dim</span>(<span class="fu">coef</span>(model.base)<span class="sc">$</span>unit)[<span class="dv">2</span>],</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">dim</span>(<span class="fu">coef</span>(model.att)<span class="sc">$</span>unit)[<span class="dv">2</span>],</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">dim</span>(<span class="fu">coef</span>(model.drug)<span class="sc">$</span>unit)[<span class="dv">2</span>],</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">dim</span>(<span class="fu">coef</span>(model.unitc)<span class="sc">$</span>unit)[<span class="dv">2</span>],</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">dim</span>(<span class="fu">coef</span>(model.att_drug)<span class="sc">$</span>unit)[<span class="dv">2</span>],</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">dim</span>(<span class="fu">coef</span>(model.att_unitc)<span class="sc">$</span>unit)[<span class="dv">2</span>],</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>           <span class="fu">dim</span>(<span class="fu">coef</span>(model.drug_unitc)<span class="sc">$</span>unit)[<span class="dv">2</span>],</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>           <span class="fu">dim</span>(<span class="fu">coef</span>(model.att_drug_unitc)<span class="sc">$</span>unit)[<span class="dv">2</span>])</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># r2_type = 1 # marginal</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>r2_type <span class="ot">=</span> <span class="dv">2</span> <span class="co"># conditional</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co"># get r2</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>r2_model <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">r.squaredGLMM</span>(model.base)[r2_type],</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">r.squaredGLMM</span>(model.att)[r2_type],</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">r.squaredGLMM</span>(model.drug)[r2_type],</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">r.squaredGLMM</span>(model.unitc)[r2_type],</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>             <span class="fu">r.squaredGLMM</span>(model.att_drug)[r2_type],</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">r.squaredGLMM</span>(model.att_unitc)[r2_type],</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>             <span class="fu">r.squaredGLMM</span>(model.drug_unitc)[r2_type],</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">r.squaredGLMM</span>(model.att_drug_unitc)[r2_type])</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co">#compute bayes factor</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>BF <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">R2.to.bf</span>(<span class="at">n=</span>n, <span class="at">nPred=</span>n_pred, <span class="at">r2=</span>r2_model))</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(BF) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Model1&quot;</span>,<span class="st">&quot;Model2&quot;</span>,<span class="st">&quot;BF&quot;</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;R2 values for each model fit:&#39;</span>)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(r2_model)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="co"># print(BF, nrows = 100)</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(BF)</span></code></pre></div>
<pre><code>## [1] &quot;R2 values for each model fit:&quot;
## [1] 0.8054289 0.8817419 0.9033728 0.9033758 0.9036878 0.9179408 0.9180777
## [8] 0.9183160</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Model1</th>
<th align="right">Model2</th>
<th align="right">BF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3.221115e+04</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4.272048e+05</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3.516077e+04</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">3.570248e+03</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">6</td>
<td align="right">1.752402e+04</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">7</td>
<td align="right">1.925511e+03</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">8</td>
<td align="right">2.353717e+02</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1.326264e+01</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">1.091571e+00</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">5</td>
<td align="right">1.108389e-01</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">5.440359e-01</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">7</td>
<td align="right">5.977780e-02</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">8</td>
<td align="right">7.307100e-03</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">8.230420e-02</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">5</td>
<td align="right">8.357200e-03</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">6</td>
<td align="right">4.102020e-02</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7</td>
<td align="right">4.507200e-03</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">8</td>
<td align="right">5.510000e-04</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">5</td>
<td align="right">1.015407e-01</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">6</td>
<td align="right">4.983970e-01</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">7</td>
<td align="right">5.476300e-02</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">8</td>
<td align="right">6.694200e-03</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">6</td>
<td align="right">4.908348e+00</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">7</td>
<td align="right">5.393213e-01</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">8</td>
<td align="right">6.592590e-02</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">7</td>
<td align="right">1.098784e-01</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">8</td>
<td align="right">1.343140e-02</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">8</td>
<td align="right">1.222386e-01</td>
</tr>
</tbody>
</table>

</body>
</html>
